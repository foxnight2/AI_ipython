// protoc --python_output=. pp.proto

syntax = "proto2";


// 
message TensorShape {
    repeated int64 dim = 1;
}

message Tensor {
    TensorShape shape = 1;
    repeated float data = 2 [packed = true];
    repeated float grad = 3 [packed = true];
    // repeated double data = 4 [packed = true];
    // repeated double grad = 5 [packed = true];
    optional bytes data = 4; // base64.b64encode(numpy.ndarray)
}

message TensorVector {
  repeated Tensor tensors = 1;
}


// 
message SolverParameter {
    
    optional string name = 1;
    optional string model_file = 2;
    
    optional ModelParameter model = 100; 
}


message ModelParameter {
    
    optional string name = 1;
    
    repeated ModuleParameter module = 100;
}


message ModuleParameter {
    optional string name = 1; 
    optional string type = 2; 
    repeated string bottom = 3;
    repeated string top = 4;
    
    optional Conv2dParameter conv2d_param = 100;
    optional ResNetParameter resnet_param = 101;

}



message Conv2dParameter {

    uint32 in_channels = 1;
    uint32 out_channels = 2; 
    repeated uint32 kernel = 3; 
    repeated uint32 stride = 4;
    repeated uint32 padding = 5;
}

message ResNetParameter {
    optional string layers = 1;
    optional int32 freeze_at = 2;
    
}